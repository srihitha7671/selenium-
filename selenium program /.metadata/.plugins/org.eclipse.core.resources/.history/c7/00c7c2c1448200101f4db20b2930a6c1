package pac1;

import org.openqa.selenium.By;
import org.openqa.selenium.WebDriver;
import org.openqa.selenium.WebElement;
import org.openqa.selenium.chrome.ChromeDriver;
import org.testng.Assert;
import org.testng.Reporter;
import org.testng.annotations.AfterClass;
import org.testng.annotations.BeforeClass;
import org.testng.annotations.Test;

import io.github.bonigarcia.wdm.WebDriverManager;

public class Lab4TestNGTest {
    WebDriver driver;

    @BeforeClass
    public void setup() {
        WebDriverManager.chromedriver().setup();
        driver = new ChromeDriver();
        Reporter.log("Browser launched successfully", true);
        driver.manage().window().maximize();
        Reporter.log("Browser window maximized", true);
        driver.get("https://opensource-demo.orangehrmlive.com/web/index.php/auth/login");
        Reporter.log("Navigated to OrangeHRM Login Page", true);
    }

    @Test(priority = 1)
    public void loginTest() throws InterruptedException {
        Thread.sleep(2000); // wait for page load
        driver.findElement(By.name("username")).sendKeys("Admin");
        driver.findElement(By.name("password")).sendKeys("admin123");
        driver.findElement(By.cssSelector("button[type='submit']")).click();
        Reporter.log("Login attempted with Admin credentials", true);

        // Assertion - check if dashboard is visible
        Thread.sleep(2000);
        WebElement dashboardHeader = driver.findElement(By.xpath("//h6[text()='Dashboard']"));
        Assert.assertTrue(dashboardHeader.isDisplayed(), "Dashboard not displayed after login!");
        Reporter.log("Login successful - Dashboard displayed", true);
    }

    @Test(priority = 2)
    public void verifyAdminMenu() throws InterruptedException {
        Thread.sleep(2000);
        WebElement adminMenu = driver.findElement(By.xpath("//span[text()='Admin']"));
        Assert.assertTrue(adminMenu.isDisplayed(), "Admin menu is not visible!");
        Reporter.log("Admin menu is displayed on the dashboard", true);

        adminMenu.click();
        Reporter.log("Clicked on Admin menu", true);

        Thread.sleep(2000);
        WebElement userManagement = driver.findElement(By.xpath("//h6[text()='User Management']"));
        Assert.assertTrue(userManagement.isDisplayed(), "User Management page not opened!");
        Reporter.log("User Management page displayed after clicking Admin menu", true);
    }

    @AfterClass
    public void tearDown() {
        if (driver != null) {
            driver.quit();
            Reporter.log("Browser closed successfully", true);
        }
    }
}